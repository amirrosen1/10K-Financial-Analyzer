over the corresponding service term, generally between two and five years. The majority of restricted stock unit awards are granted at the date of hire or in Q2 as part of the annual compensation review and primarily vest semi-annually in Q2 and Q4 of the relevant compensation year. Stock Award Activity Stock-based compensation expense is as follows (in millions): Year Ended December 31, 2021 2022 2023 Cost of sales $ 540 $ 757 $ 836 Fulfillment 1,946 2,745 3,090 Technology and infrastructure 6,645 10,621 13,434 Sales and marketing 2,530 3,875 4,623 General and administrative 1,096 1,623 2,040 Total stock-based compensation